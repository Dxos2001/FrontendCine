<!-- cartelera.component.html -->
<div class="min-h-screen bg-gray-900 text-white">
  
  <!-- Header -->
  <header class="bg-gradient-to-r from-purple-900 to-blue-900 shadow-lg">
    <div class="container mx-auto px-4 py-6">
      <h1 class="text-4xl font-bold text-center mb-2">üé¨ CineMax</h1>
      <p class="text-center text-gray-300">La mejor experiencia cinematogr√°fica</p>
      <button 
        class="bg-purple-600 hover:bg-purple-700 px-6 py-2 rounded-lg font-semibold transition-colors duration-300 mt-4"
        (click)="abrirLogin()"
      >
        {{ nomUsuario || 'Iniciar Sesi√≥n' }}
      </button>
    </div>
  </header>

    <!-- Filtros -->
    <section class="container mx-auto px-4 py-8">
    <div class="bg-gradient-to-r from-slate-900/80 to-slate-800/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-700/50 shadow-2xl">
        <!-- Header de filtros -->
        <div class="flex items-center gap-3 mb-6">
        <div class="p-2 bg-gradient-to-r from-blue-600/30 to-purple-600/30 rounded-lg">
            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
            </svg>
        </div>
        <h3 class="text-xl font-bold text-white">Filtrar Pel√≠culas</h3>
        </div>

        <!-- Filtros -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        
        <!-- Filtro por T√≠tulo -->
        <div class="filter-group">
            <label class="filter-label">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            Buscar por t√≠tulo
            </label>
            <div class="input-container">
            <input 
                type="text" 
                class="filter-input"
                placeholder="Ingresa el t√≠tulo de la pel√≠cula..."
                [(ngModel)]="filtroTitulo"
            >
            <div class="input-icon">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
            </div>
        </div>

        <!-- Filtro por G√©nero -->
        <div class="filter-group">
            <label class="filter-label">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4zM9 6v10h6V6H9z"></path>
            </svg>
            G√©nero
            </label>
            <div class="select-container">
            <select 
                class="filter-select"
                [(ngModel)]="generoSeleccionado"
            >
                <option value=0>Todos los g√©neros</option>
                <option 
                *ngFor="let genero of filtroGeneros" 
                [value]="genero.id"
                >
                {{ genero.nombre }}
                </option>
            </select>
            <div class="select-icon">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
            </div>
        </div>

        <!-- Filtro por Sala -->
        <div class="filter-group">
            <label class="filter-label">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
            Sala
            </label>
            <div class="select-container">
            <select 
                class="filter-select"
                [(ngModel)]="salaSeleccionada"
            >
                <option value=0>Todas las salas</option>
                <option 
                *ngFor="let sala of filtroSalas" 
                [value]="sala.id"
                >
                {{ sala.nombre }}
                </option>
            </select>
            <div class="select-icon">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
            </div>
        </div>

        </div>

        <!-- Botones de acci√≥n -->
        <div class="flex flex-wrap gap-3 mt-6 pt-4 border-t border-slate-700/50">
        <button 
            class="action-button primary"
            (click)="getPeliculasXSala()"
        >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            Aplicar Filtros
        </button>
        

        <div class="flex-1"></div>

        <div class="results-counter">
            <span class="counter-text">
            {{ peliculasFiltradas?.length || 0 }} pel√≠culas encontradas
            </span>
        </div>
        </div>
    </div>
    </section>

  <!-- Loading State -->
  <div *ngIf="cargando" class="container mx-auto px-4 py-12">
    <div class="flex justify-center items-center">
      <div class="loading-spinner"></div>
      <span class="ml-4 text-xl">Cargando pel√≠culas...</span>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !cargando" class="container mx-auto px-4 py-12">
    <div class="bg-red-900 border border-red-700 rounded-lg p-6 text-center">
      <div class="text-4xl mb-4">‚ö†Ô∏è</div>
      <h3 class="text-xl font-bold mb-2">Error al cargar</h3>
      <p class="text-red-300 mb-4">{{ error }}</p>
      <button 
        class="bg-red-600 hover:bg-red-700 px-6 py-2 rounded-lg font-semibold transition-colors duration-300"
      >
        Reintentar
      </button>
    </div>
  </div>

  <!-- Grid de Pel√≠culas -->
  <main class="container mx-auto px-4 pb-12" *ngIf="!cargando && !error">
    <div class="movie-grid">
      <div 
        *ngFor="let pelicula of cartelera"
        class="movie-card"
      >
        <!-- Poster -->
        <div class="movie-poster-container group">
          <img 
            [src]="pelicula.img" 
            [alt]="pelicula.titulo"
            class="movie-poster"
            loading="lazy"
          >
        </div>

        <!-- Informaci√≥n de la pel√≠cula -->
        <div class="movie-info">
          <h3 class="movie-title">{{ pelicula.titulo }}</h3>
          
          <!-- G√©nero y duraci√≥n -->
          <div class="movie-meta">
            <span class="genre-badge" *ngFor="let genero of pelicula.generos">{{ genero.nombre }}</span>
        </div>
        <span class="duration">‚è± {{ pelicula.duracion }} minutos</span>

          <!-- Sinopsis -->
          <p class="movie-synopsis mt-3 text-gray-300 text-sm leading-relaxed line-clamp-4 bg-gray-800/60 rounded-lg p-3 shadow-inner border border-gray-700">
            {{ pelicula.sinopsis }}
          </p>

        <!-- Horario m√°s cercano -->
        <div class="movie-detail" *ngIf="pelicula.funciones && pelicula.funciones.length > 0">
            <p class="detail-label">Pr√≥xima funci√≥n:</p>
            <div class="schedule-buttons">
                <p class="schedule-label flex items-center gap-2 text-blue-400 font-semibold">
                    <svg class="w-5 h-5 inline-block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 7V6a2 2 0 012-2h12a2 2 0 012 2v1M4 7h16M4 7v11a2 2 0 002 2h12a2 2 0 002-2V7M16 11v2m-4-2v2m-4-2v2" />
                    </svg>
                    Sala: <span class="font-bold">{{ pelicula.funciones[0].sala.nombre }}</span>
                </p>
                <p class="schedule-label flex items-center gap-2 text-green-400 font-semibold">
                    <svg class="w-5 h-5 inline-block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Fecha: <span class="font-bold">{{ pelicula.funciones[0].fecha }}</span>
                </p>
                <button class="schedule-btn">
                    {{ pelicula.funciones[0].horaInicio }}
                </button>
                <p class="schedule-label">Asientos Disponibles: {{ pelicula.funciones[0].asientosDisponibles }}</p>
            </div>

          <!-- Precio y bot√≥n de reserva -->
          <div class="movie-footer">
            <div class="price-section">
              <span class="price">S/{{ pelicula.funciones[0].precioEntrada }}</span>
              <span class="price-label">por entrada</span>
            </div>
            <button 
              class="reserve-btn"
                (click)="detallePelicula(pelicula)"
            >
              Ver detalle
            </button>
          </div>

            
        </div>


        </div>
      </div>
    </div>

    <!-- Mensaje cuando no hay pel√≠culas -->
    <div *ngIf="peliculasFiltradas.length === 0" class="empty-state">
      <div class="empty-icon">üé≠</div>
      <h3 class="empty-title">No hay pel√≠culas disponibles</h3>
      <p class="empty-message">Intenta con otro g√©nero o revisa m√°s tarde</p>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container mx-auto px-4 text-center">
      <h3 class="footer-title">CineMax</h3>
      <div class="footer-links">
        <a href="#" class="footer-link">Cartelera</a>
        <a href="#" class="footer-link">Promociones</a>
        <a href="#" class="footer-link">Contacto</a>
        <a href="#" class="footer-link">Nosotros</a>
      </div>
      <p class="footer-copyright">¬© 2024 CineMax. Todos los derechos reservados.</p>
    </div>
</footer>
